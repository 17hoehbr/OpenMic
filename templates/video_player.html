{% extends 'tv_base.html' %}
{% block head %}
  <style>
    video{
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
{% endblock %}

{% block content %}
  <video id="video">
      <source src="/songs/{{ next_song }}.mp4" type="video/mp4">
      Your browser does not support the video tag.
  </video>

  <script>
    const socket = io("{{ url_for('tv') }}");
    const video = document.getElementById('video');

    socket.on('player_restart', function() {
      video.currentTime = 0;
    });

    socket.on('player_pause', function() {
      if (!video.paused) {
          video.pause();
      } else {
          video.play();
      }
    });

    window.onload = function() {
      socket.emit('play_video');
    };

    document.addEventListener('keydown', function(event) {
      // Check if the pressed key is the space bar (key code 32)
      if (event.keyCode === 32) {
        // Toggle video playback
        if (video.paused) {
            video.play();
        } else {
            video.pause();
        }
      }
    });

    socket.on('player_skip', function() {
      video.currentTime = video.duration;
    });

    video.addEventListener('ended',function(){
      location.href = "{{ url_for('tv') }}";
    });

  </script>
{% endblock %}